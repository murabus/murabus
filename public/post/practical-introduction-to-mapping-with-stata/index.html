<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  

  
  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Murat Abus" />

  
  
  
    
  
  <meta name="description" content="This is a relatively short, practical introduction to mapping with Stata designed to get the newcomer started in no time and provide a quick refresher as needed." />

  
  <link rel="alternate" hreflang="en-us" href="https://muratabus.com/post/practical-introduction-to-mapping-with-stata/" />

  
  
  
    <meta name="theme-color" content="#ae1717" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.5392e65aa6760c972e2348b3e4d2b6e0.css" />

  



  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_huad31e523df4f8e5aace4520ae71cf852_1051347_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_huad31e523df4f8e5aace4520ae71cf852_1051347_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://muratabus.com/post/practical-introduction-to-mapping-with-stata/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@@muratabus" />
    <meta property="twitter:creator" content="@@muratabus" />
  
  <meta property="og:site_name" content="Murat Abus" />
  <meta property="og:url" content="https://muratabus.com/post/practical-introduction-to-mapping-with-stata/" />
  <meta property="og:title" content="Practical Introduction to Mapping with Stata | Murat Abus" />
  <meta property="og:description" content="This is a relatively short, practical introduction to mapping with Stata designed to get the newcomer started in no time and provide a quick refresher as needed." /><meta property="og:image" content="https://muratabus.com/post/practical-introduction-to-mapping-with-stata/featured.png" />
    <meta property="twitter:image" content="https://muratabus.com/post/practical-introduction-to-mapping-with-stata/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-06-29T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-06-29T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://muratabus.com/post/practical-introduction-to-mapping-with-stata/"
  },
  "headline": "Practical Introduction to Mapping with Stata",
  
  "image": [
    "https://muratabus.com/post/practical-introduction-to-mapping-with-stata/featured.png"
  ],
  
  "datePublished": "2022-06-29T00:00:00Z",
  "dateModified": "2022-06-29T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Murat Abus"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Murat Abus",
    "logo": {
      "@type": "ImageObject",
      "url": "https://muratabus.com/media/icon_huad31e523df4f8e5aace4520ae71cf852_1051347_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "This is a relatively short, practical introduction to mapping with Stata designed to get the newcomer started in no time and provide a quick refresher as needed."
}
</script>

  

  

  

  





  <title>Practical Introduction to Mapping with Stata | Murat Abus</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="21ea621fd78aad79573ae6002b06329f" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.29074ab7aab33312908c74d6176a3197.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Murat Abus</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Murat Abus</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/pictures/"><span>Pictures</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/posts/"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/research/"><span>Research</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/worksinprogress/"><span>Work in Progress</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/teaching/"><span>Teaching</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/studenttestimonials"><span>Student Testimonials</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  





















  
  


<div class="article-container pt-3">
  <h1>Practical Introduction to Mapping with Stata</h1>

  
  <p class="page-subtitle">This is a relatively short, practical introduction to mapping with Stata designed to get the newcomer started in no time and provide a quick refresher as needed.</p>
  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      Murat Abus</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Jun 29, 2022
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/tutorial/">Tutorial</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 237px;">
  <div style="position: relative">
    <img src="/post/practical-introduction-to-mapping-with-stata/featured_hu4ac87ef6c6c8791cf2816af4ac531a67_3889491_720x2500_fit_q75_h2_lanczos_3.webp" width="720" height="237" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p>In this tutorial<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, we will draw a choropleth map (assigning various colors to levels of a variable to show intensity) of mosque density in Turkey at the district level.<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> In this first step of spatial analysis, we need two separate things: A map with the required boundaries marking the units we are interested in, and substantive data corresponding to the geographical units marked by the borders in the map. The map files are freely available on the internet, and the one we will use can be obtained from  <a href="https://data.humdata.org/dataset/turkey-administrative-boundaries-levels-0-1-2" target="_blank" rel="noopener">Shapefiles</a>. We will need the <strong>turkey_administrativelevels0_1_2.zip</strong> file. This zip file contains the administrative boundaries for the country, provinces, and districts. In this tutorial, we are creating a map at the district level and this is the second level. After unzipping the file, extract the following files to a folder of your choice:<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></p>
<ol>
<li>tur_polbnda_adm2.cpg</li>
<li>tur_polbnda_adm2.dbf</li>
<li>tur_polbnda_adm2.prj</li>
<li>tur_polbnda_adm2.sbn</li>
<li>tur_polbnda_adm2.sbx</li>
<li>tur_polbnda_adm2.shp</li>
<li>tur_polbnda_adm2.shp.xml</li>
<li>tur_polbnda_adm2.shx</li>
</ol>
<p>Now that we have our shapefile in folder, we will need to generate / get our substantive data for the variable that we want to map.<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>For this tutorial, grab the <a href="https://github.com/murabus/religion_data/blob/main/abus_mosque_density.dta" target="_blank" rel="noopener">substantive dataset</a> and place it in the same folder as with the shapefiles.<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup></p>
<p>Before we get down to it, two words of advice: First, it is important to realize these types of detailed maps do not show causation <em>per se</em> (Healy 2018, 182).<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup> Second, I intentionally did not provide a .do file so that the reader will type the commands themselves, and generate their own .do files with the comments that they think will be useful in the future. This - I have been led to believe - is a best practice in learning.</p>
<p>Let us start typing those commands!</p>
<h2 id="1-preliminaries">1. Preliminaries</h2>
<p>First order of business, as usual, is to check where in the file system we are. Using the following command, check the current working directory and point Stata to the folder of our files by Shift+Control+F.</p>
<pre tabindex="0"><code>pwd
</code></pre><p>Now that we are where we want to be in the file system, we will use Stata&rsquo;s built-in spatial commands. First, issue the following command to have Stata use all the shapefiles in our folder to generate a .dta dataset that we can manipulate using Stata.</p>
<pre tabindex="0"><code>spshape2dta tur_polbnda_adm2, replace
</code></pre><p>We will see the following output on the console, confirming that Stata used all the shapefiles to create a .dta file that we can manipulate.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="my-first-image" srcset="
               /post/practical-introduction-to-mapping-with-stata/image1_hudb2b7260da96eea5256667d9e3f90e9e_21960_bcb5a5b202c5c7f93b9d3dd55dedac63.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image1_hudb2b7260da96eea5256667d9e3f90e9e_21960_e26da44b5bf0cb9515f246ed5b3ca189.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image1_hudb2b7260da96eea5256667d9e3f90e9e_21960_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image1_hudb2b7260da96eea5256667d9e3f90e9e_21960_bcb5a5b202c5c7f93b9d3dd55dedac63.webp"
               width="715"
               height="271"
               loading="lazy" data-zoomable /></div>
  </div></figure>

Let us load this dataset and have a look at it.</p>
<pre tabindex="0"><code>use &#34;tur_polbnda_adm2.dta&#34;, clear
describe
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="my-second-image" srcset="
               /post/practical-introduction-to-mapping-with-stata/image2_hud962fe639f3a8cb257a1438b4035bfd2_42045_dee582d493fc8f3c1a93613ef8ba16af.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image2_hud962fe639f3a8cb257a1438b4035bfd2_42045_6ee7788b3bb3f7bbe71ea897c63e9037.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image2_hud962fe639f3a8cb257a1438b4035bfd2_42045_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image2_hud962fe639f3a8cb257a1438b4035bfd2_42045_dee582d493fc8f3c1a93613ef8ba16af.webp"
               width="633"
               height="445"
               loading="lazy" data-zoomable /></div>
  </div></figure>

Looking at the generated dataset, there are two important variables. These are the &ldquo;_ID&rdquo; and &ldquo;pcode&rdquo; variables. The main logic here is to be able to have a unique identifier for each geographic unit. A note from this dataset is that even though &ldquo;_ID&rdquo; variable starts from 1 and increases the corresponding &ldquo;pcode&rdquo; variable does not start with the first district (alphabetical or the first province). This is an important concern, so we will do some data cleaning to make sure that the first district has an &ldquo;id&rdquo; of &ldquo;1&rdquo; and corresponds to &ldquo;TUR001001&rdquo;.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="my-third-image" srcset="
               /post/practical-introduction-to-mapping-with-stata/image3_huc995d9dcd9eae6efc1fbc7d2b7bcff1a_46971_34f0175073cbfb0dac78f969eaefe657.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image3_huc995d9dcd9eae6efc1fbc7d2b7bcff1a_46971_e671cac998422c32da343e4010a4184c.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image3_huc995d9dcd9eae6efc1fbc7d2b7bcff1a_46971_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image3_huc995d9dcd9eae6efc1fbc7d2b7bcff1a_46971_34f0175073cbfb0dac78f969eaefe657.webp"
               width="760"
               height="199"
               loading="lazy" data-zoomable /></div>
  </div></figure>

&ldquo;pcode&rdquo; variable is string, so we can not do any manipulation, so with the following code we first encode it and then based on the code we sort the dataset. In order to have a second variable to use in uniquely identifying each unit, we also generate a new &ldquo;id&rdquo; variable startimg from 1. We want to have an ordered dataset with two unique identifiers for each geographical unit.</p>
<pre tabindex="0"><code>encode pcode, generate(dcode)
drop pcode
rename dcode pcode
sort pcode
gen id = _n 
</code></pre><p>Let us check our work.</p>
<pre tabindex="0"><code>describe
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="my-fourth-image" srcset="
               /post/practical-introduction-to-mapping-with-stata/image4_huff46fbbe2d371941615908e7032c47f2_45220_ab35d3f7e27e8fb599ec32feea2decd7.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image4_huff46fbbe2d371941615908e7032c47f2_45220_c0c59a428ddb9353dc960cb8c50cc987.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image4_huff46fbbe2d371941615908e7032c47f2_45220_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image4_huff46fbbe2d371941615908e7032c47f2_45220_ab35d3f7e27e8fb599ec32feea2decd7.webp"
               width="708"
               height="463"
               loading="lazy" data-zoomable /></div>
  </div></figure>

We have our <em>id</em> variable and <em>pcode</em> variable is not string anymore. All looks good, so we can save our map dataset:</p>
<pre tabindex="0"><code>save &#34;tur_polbnda_adm2.dta&#34;, replace
</code></pre><p>Just like we define a time-series dataset to Stata using the &ldquo;tsset&rdquo; command, while our dataset is in memory, we define it as a spatial dataset with the following command:</p>
<pre tabindex="0"><code>spset
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="spset" srcset="
               /post/practical-introduction-to-mapping-with-stata/image7_hub8e245fefa3996d1421dc3b938d0276a_13334_21b6bd18229d5862c83861a73a0ceaaf.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image7_hub8e245fefa3996d1421dc3b938d0276a_13334_063dec9aa872946316d046474b66aa4d.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image7_hub8e245fefa3996d1421dc3b938d0276a_13334_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image7_hub8e245fefa3996d1421dc3b938d0276a_13334_21b6bd18229d5862c83861a73a0ceaaf.webp"
               width="430"
               height="171"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>In order to check if this definition is successful, we use Stata&rsquo;s built-in <strong>grmap</strong> command to see if Stata can draw the borders in this dataset. This is the spatial dataset and will include only the borders.</p>
<pre tabindex="0"><code>grmap
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="grmap" srcset="
               /post/practical-introduction-to-mapping-with-stata/image8_hua7b43ebb404bda4df504558a93ee20d1_325617_f7c457cfa7e546dc816097887d0d9ea7.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image8_hua7b43ebb404bda4df504558a93ee20d1_325617_efacb4c2a9263a6c2b51abae2c2e8e75.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image8_hua7b43ebb404bda4df504558a93ee20d1_325617_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image8_hua7b43ebb404bda4df504558a93ee20d1_325617_f7c457cfa7e546dc816097887d0d9ea7.webp"
               width="760"
               height="304"
               loading="lazy" data-zoomable /></div>
  </div></figure>

This confirms that our map data is properly defined as we see the borders of districts drawn.
Next order of business is the coordinate system. In the console output above we see that the coordinate system is planar, so we are modifying it with the following command:</p>
<pre tabindex="0"><code>spset, modify coordsys(latlong, kilometers)
</code></pre><p>Our preliminary work is done. We prepared our map dataset to be used in the analysis. Now we need to merge the datasets in such a way that the new dataset will now not only have borders (spatial information) but also values of our variable of interest (here mosque density) corresponding to each of those units. So, it will be possible to create a choropleth map. We save our dataset before proceeding.</p>
<pre tabindex="0"><code>save &#34;tur_polbnda_adm2.dta&#34;, replace
</code></pre><h2 id="2-merging-datasets">2. Merging Datasets</h2>
<p>Let us load our substantive dataset of this tutorial and have a look at it.</p>
<pre tabindex="0"><code>use &#34;abus_mosque_density.dta&#34;, clear
describe
</code></pre><p>A look at the first few lines of the dataset show that each district has an <em>id</em> variable starting from 1 and the counting starts from the very first district of the first province (<em>pcode</em> starts from &ldquo;TUR001001&rdquo;). This is the way I prepared this substantive dataset and I suggest using two unique identifiers<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> for each observation as a best practice.
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="substantivedata" srcset="
               /post/practical-introduction-to-mapping-with-stata/image5_hu8014cf6f2fd40f5fd3683e507b975723_110240_845f4ff2443a5231ea4046c0bc143f7b.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image5_hu8014cf6f2fd40f5fd3683e507b975723_110240_be242f40bad67a007e7ba82b4e9cfd69.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image5_hu8014cf6f2fd40f5fd3683e507b975723_110240_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image5_hu8014cf6f2fd40f5fd3683e507b975723_110240_845f4ff2443a5231ea4046c0bc143f7b.webp"
               width="520"
               height="760"
               loading="lazy" data-zoomable /></div>
  </div></figure>

We first load our spatial dataset:</p>
<pre tabindex="0"><code>use &#34;tur_polbnda_adm2.dta&#34;, clear
</code></pre><p>Then we load our master dataset (substantial dataset).</p>
<pre tabindex="0"><code>use &#34;abus_mosque_density.dta&#34;, clear    
</code></pre><p>The second dataset we load in this workflow is our main dataset. The code below allows us to merge the datasets. In effect, we are adding spatial data to our dataset. We are using our two unique identifiers. This means those observations that are uniquely identified in both datasets become one observation and additional information is added to that observation (here spatial data).</p>
<pre tabindex="0"><code>merge 1:1 pcode id using &#34;tur_polbnda_adm2.dta&#34;
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="merge" srcset="
               /post/practical-introduction-to-mapping-with-stata/image6_hubea4506021e546e5d82b4291d25756d3_15009_5e4497865347cd14ecad8d1cfbd0a02b.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/image6_hubea4506021e546e5d82b4291d25756d3_15009_1c84317f7df35dfd0064a8b344ce74d8.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/image6_hubea4506021e546e5d82b4291d25756d3_15009_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/image6_hubea4506021e546e5d82b4291d25756d3_15009_5e4497865347cd14ecad8d1cfbd0a02b.webp"
               width="593"
               height="234"
               loading="lazy" data-zoomable /></div>
  </div></figure>

The Stata console output shows that there was a match of 973 districts. The benefit of spending time and thinking about identifiers and data cleaning is usually to prevent problems with merging at this stage. In order to keep our data clean of unncessary variables, we drop the <em>_merge</em> variable:</p>
<pre tabindex="0"><code>drop _merge
</code></pre><h2 id="3-the-map">3. The Map!</h2>
<p>Now we have a dataset that is &ldquo;spset&rdquo; and includes the spatial information of the variable of interest (mosque density). It is now a matter of issuing a <strong>grmap</strong> command with the variable to be mapped (here mosquedens). <strong>grmap</strong> has alot of options that can be checked by</p>
<pre tabindex="0"><code>help grmap
</code></pre><p>Below, we are using 7 intervals and through the custom option we define the breaking points for these intervals. We are using the <em>Greens</em> color scheme from Brewer and we are including the count as a legend (but without an explanatory text).</p>
<pre tabindex="0"><code>grmap mosquedens, clnumber(7) clmethod(custom) ///
clbreaks(0 1 2 3 4 6 20) fcolor(Greens) legcount
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="themap" srcset="
               /post/practical-introduction-to-mapping-with-stata/mosquedensity_hu4ac87ef6c6c8791cf2816af4ac531a67_3889491_3dda550fed5f1d853071a6d4478c95e5.webp 400w,
               /post/practical-introduction-to-mapping-with-stata/mosquedensity_hu4ac87ef6c6c8791cf2816af4ac531a67_3889491_f8a2d4135ec1c39d3b7d3b0cf8fc2c9a.webp 760w,
               /post/practical-introduction-to-mapping-with-stata/mosquedensity_hu4ac87ef6c6c8791cf2816af4ac531a67_3889491_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/practical-introduction-to-mapping-with-stata/mosquedensity_hu4ac87ef6c6c8791cf2816af4ac531a67_3889491_3dda550fed5f1d853071a6d4478c95e5.webp"
               width="760"
               height="250"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>We can save our map as a regular Stata .gph file, which is 🆒.</p>
<pre tabindex="0"><code>save &#34;mosquedensity.gph&#34;, replace
</code></pre><p>We can export it to a number of formats.</p>
<pre tabindex="0"><code>graph export &#34;mosquedensity.pdf&#34;, replace
graph export &#34;mosquedensity.svg&#34;, replace
</code></pre><p>Thanks for reading!<sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>This fast tutorial was inspired by <a href="https://cwimpy.com" target="_blank" rel="noopener">Cameron Wimpy</a>.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>For a more detailed and formal introduction, please see the multi-part series of <a href="https://medium.com/the-stata-guide/covid-19-visualizations-with-stata-part-4-maps-fbd4fe2642f6" target="_blank" rel="noopener">Asjad Naqvi</a>.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Note that for this particular case, the .zip file included files ending with &ldquo;0&rdquo;, &ldquo;1&rdquo;, and &ldquo;2&rdquo;. These correspond to the administrative units of the country. Files with &ldquo;0&rdquo; would be used to draw the country borders, files with &ldquo;1&rdquo; would be used to draw the province borders and here we are using the files with &ldquo;2&rdquo; to draw the district borders. By the same logic, there are separate shapefiles containing information about the railways, waterways, roads, etc.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>This tutorial assumes that the files be placed in a single folder. Beyond that there is no assumption about any particular folder-subfolder structure choice.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Note that I compiled this dataset to reflect mosque density for each of 973 administrative districts in Turkey.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p>Healy, Kieran. 2018. <em>Data Visualization: A Practical Introduction.</em> Princeton University Press.&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p>Unique identifiers are also referred to as <em>keys</em>.&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p>Screenshots are from Stata IC 16.1 running on a Linux machine (Ubuntu 22.04 / GNOME 42.1)&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/stata/">Stata</a>
  
  <a class="badge badge-light" href="/tag/mapping/">Mapping</a>
  
  <a class="badge badge-light" href="/tag/choropleth-map/">Choropleth map</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
  </ul>
</div>











  
  
    



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://muratabus.com/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_huff3f2ffffbc4efd35f7816abaf6051c1_1117474_270x270_fill_q75_lanczos_center.jpg" alt="Murat Abus"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://muratabus.com/">Murat Abus</a></h5>
      <h6 class="card-subtitle">Ph.D. Student, Political Science</h6>
      <p class="card-text">I study political behavior, public opinion, democracy / autocracy, gender in politics, and methodology.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/cv-abus.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:mabus@tamu.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/muratabus" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=U80XvUEAAAAJ&amp;hl=en&amp;oi=ao" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/murabus" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0002-0153-5010" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Murat-Abus" target="_blank" rel="noopener">
        <i class="ai ai-researchgate"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.webofscience.com/wos/author/rid/GNP-2347-2022" target="_blank" rel="noopener">
        <i class="ai ai-publons"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  






  
  <p class="powered-by copyright-license-text">
    © 2023 Murat Abus
  </p>
  




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.53d67dc2cb1ebceb89d5e2aba2f86112.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":true}</script>

    
    
      <script src="/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js" type="module"></script>
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.ab2f2890dbe3e2e83579366d3d6e8fd9.js"></script>

    
    
    
    
    
    
      
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>






</body>
</html>
